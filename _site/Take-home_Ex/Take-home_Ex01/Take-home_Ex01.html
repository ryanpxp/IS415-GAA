<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.4.555">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Ryan Peh">
<meta name="dcterms.date" content="2030-09-07">

<title>IS415-GAA - Take-home_Ex01</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="../../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../../site_libs/clipboard/clipboard.min.js"></script>
<script src="../../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../../site_libs/quarto-search/fuse.min.js"></script>
<script src="../../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../../">
<script src="../../site_libs/quarto-html/quarto.js"></script>
<script src="../../site_libs/quarto-html/popper.min.js"></script>
<script src="../../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../../site_libs/quarto-html/anchor.min.js"></script>
<link href="../../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../../site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../../site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>


<link rel="stylesheet" href="../../styles.css">
</head>

<body class="nav-fixed">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg " data-bs-theme="dark">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container mx-auto">
    <a class="navbar-brand" href="../../index.html">
    <span class="navbar-title">IS415-GAA</span>
    </a>
  </div>
            <div id="quarto-search" class="" title="Search"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll me-auto">
  <li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu-hands-on-exercise" role="button" data-bs-toggle="dropdown" aria-expanded="false">
 <span class="menu-text">Hands-on Exercise</span>
    </a>
    <ul class="dropdown-menu" aria-labelledby="nav-menu-hands-on-exercise">    
        <li>
    <a class="dropdown-item" href="../../Hands-on_Ex/Hands-on_Ex01/Hands-on_Ex01.html">
 <span class="dropdown-text">Hands-on Exercise 1</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../Hands-on_Ex/Hands-on_Ex02/Hands-on_Ex02.html">
 <span class="dropdown-text">Hands-on Exercise 2</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../Hands-on_Ex/Hands-on_Ex03/Hands-on_Ex03.html">
 <span class="dropdown-text">Hands-on Exercise 3</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../Hands-on_Ex/Hands-on_Ex04/Hands-on_Ex04.html">
 <span class="dropdown-text">Hands-on Exercise 4</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../Hands-on_Ex/Hands-on_Ex05/Hands-on_Ex05.html">
 <span class="dropdown-text">Hands-on Exercise 5</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../Hands-on_Ex/Hands-on_Ex06/Hands-on_Ex06.html">
 <span class="dropdown-text">Hands-on Exercise 6</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../Hands-on_Ex/Hands-on_Ex07/Hands-on_Ex07.html">
 <span class="dropdown-text">Hands-on Exercise 7&amp;8</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../Hands-on_Ex/Hands-on_Ex09/Hands-on_Ex09.html">
 <span class="dropdown-text">Hands-on Exercise 9</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../Hands-on_Ex/Hands-on_Ex10/Hands-on_Ex10.html">
 <span class="dropdown-text">Hands-on Exercise 10</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../Hands-on_Ex/Hands-on_Ex11/Hands-on_Ex11.html">
 <span class="dropdown-text">Hands-on Exercise 11</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../Hands-on_Ex/Hands-on_Ex12/Hands-on_Ex12.html">
 <span class="dropdown-text">Hands-on Exercise 12</span></a>
  </li>  
    </ul>
  </li>
  <li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu-in-class-exercise" role="button" data-bs-toggle="dropdown" aria-expanded="false">
 <span class="menu-text">In-class Exercise</span>
    </a>
    <ul class="dropdown-menu" aria-labelledby="nav-menu-in-class-exercise">    
        <li>
    <a class="dropdown-item" href="../../In-class_Ex/In-class_Ex01/In-class_Ex01.html">
 <span class="dropdown-text">In-class Exercise 1</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../In-class_Ex/In-class_Ex02/In-class_Ex02.html">
 <span class="dropdown-text">In-class Exercise 2</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../In-class_Ex/In-class_Ex03/In-class_Ex03.html">
 <span class="dropdown-text">In-class Exercise 3</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../In-class_Ex/In-class_Ex04/In-class_Ex04.html">
 <span class="dropdown-text">In-class Exercise 4</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../In-class_Ex/In-class_Ex05/In-class_Ex05.html">
 <span class="dropdown-text">In-class Exercise 5</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../In-class_Ex/In-class_Ex06/In-class_Ex06.html">
 <span class="dropdown-text">In-class Exercise 6</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../In-class_Ex/In-class_Ex07/In-class_Ex07.html">
 <span class="dropdown-text">In-class Exercise 7</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../In-class_Ex/In-class_Ex08/In-class_Ex08.html">
 <span class="dropdown-text">In-class Exercise 8</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../In-class_Ex/In-class_Ex09/In-class_Ex09.html">
 <span class="dropdown-text">In-class Exercise 9</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../In-class_Ex/In-class_Ex10/In-class_Ex10.html">
 <span class="dropdown-text">In-class Exercise 10</span></a>
  </li>  
    </ul>
  </li>
  <li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu-take-home-exercise" role="button" data-bs-toggle="dropdown" aria-expanded="false">
 <span class="menu-text">Take-Home Exercise</span>
    </a>
    <ul class="dropdown-menu" aria-labelledby="nav-menu-take-home-exercise">    
        <li>
    <a class="dropdown-item" href="../../Take-home_Ex/Take-home_Ex01/Take-home_Ex01.html">
 <span class="dropdown-text">Take-home Exercise 1</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../Take-home_Ex/Take-home_Ex02/Take-home_Ex02.html">
 <span class="dropdown-text">Take-home Exercise 2</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../Take-home_Ex/Take-home_Ex03/Take-home_Ex03.html">
 <span class="dropdown-text">Take-home Exercise 3</span></a>
  </li>  
    </ul>
  </li>
</ul>
            <ul class="navbar-nav navbar-nav-scroll ms-auto">
  <li class="nav-item">
    <a class="nav-link" href="../../index.html"> 
<span class="menu-text">Home</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../../about.html"> 
<span class="menu-text">About</span></a>
  </li>  
</ul>
          </div> <!-- /navcollapse -->
          <div class="quarto-navbar-tools">
</div>
      </div> <!-- /container-fluid -->
    </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#overview" id="toc-overview" class="nav-link active" data-scroll-target="#overview"><strong>1 Overview</strong></a>
  <ul class="collapse">
  <li><a href="#objective" id="toc-objective" class="nav-link" data-scroll-target="#objective"><strong>1.1 Objective</strong></a></li>
  <li><a href="#background" id="toc-background" class="nav-link" data-scroll-target="#background">1.2 Background</a></li>
  </ul></li>
  <li><a href="#setup" id="toc-setup" class="nav-link" data-scroll-target="#setup"><strong>2 Setup</strong></a>
  <ul class="collapse">
  <li><a href="#data" id="toc-data" class="nav-link" data-scroll-target="#data"><strong>2.1 Data</strong></a></li>
  </ul></li>
  <li><a href="#the-task" id="toc-the-task" class="nav-link" data-scroll-target="#the-task"><strong>3 The Task</strong></a></li>
  <li><a href="#data-preparation" id="toc-data-preparation" class="nav-link" data-scroll-target="#data-preparation"><strong>4 Data preparation</strong></a>
  <ul class="collapse">
  <li><a href="#importing-packages" id="toc-importing-packages" class="nav-link" data-scroll-target="#importing-packages"><strong>4.1 Importing packages</strong></a></li>
  <li><a href="#importing-datasets" id="toc-importing-datasets" class="nav-link" data-scroll-target="#importing-datasets"><strong>4.2 Importing datasets</strong></a>
  <ul class="collapse">
  <li><a href="#geospatial-data" id="toc-geospatial-data" class="nav-link" data-scroll-target="#geospatial-data"><strong>4.2.1 Geospatial Data</strong></a></li>
  <li><a href="#aspatial-data" id="toc-aspatial-data" class="nav-link" data-scroll-target="#aspatial-data"><strong>4.2.2 Aspatial Data</strong></a></li>
  <li><a href="#openstreetmap-data" id="toc-openstreetmap-data" class="nav-link" data-scroll-target="#openstreetmap-data"><strong>4.2.3 OpenStreetMap Data</strong></a></li>
  </ul></li>
  </ul></li>
  <li><a href="#data-wrangling" id="toc-data-wrangling" class="nav-link" data-scroll-target="#data-wrangling"><strong>5 Data Wrangling</strong></a>
  <ul class="collapse">
  <li><a href="#kde" id="toc-kde" class="nav-link" data-scroll-target="#kde">5.1 KDE</a>
  <ul class="collapse">
  <li><a href="#adding-columns-for-quarters" id="toc-adding-columns-for-quarters" class="nav-link" data-scroll-target="#adding-columns-for-quarters"><strong>5.1.1 Adding columns for quarters</strong></a></li>
  <li><a href="#separating-the-data-by-year-and-quarter" id="toc-separating-the-data-by-year-and-quarter" class="nav-link" data-scroll-target="#separating-the-data-by-year-and-quarter"><strong>5.1.2 Separating the data by year and quarter</strong></a></li>
  <li><a href="#converting-sf-data-frames-to-sps-spatial-class" id="toc-converting-sf-data-frames-to-sps-spatial-class" class="nav-link" data-scroll-target="#converting-sf-data-frames-to-sps-spatial-class"><strong>5.1.3 Converting sf data frames to sp’s Spatial* class</strong></a></li>
  <li><a href="#converting-the-simple-features-to-spatstats-ppp-planar-point-pattern-object" id="toc-converting-the-simple-features-to-spatstats-ppp-planar-point-pattern-object" class="nav-link" data-scroll-target="#converting-the-simple-features-to-spatstats-ppp-planar-point-pattern-object"><strong>5.1.4 Converting the simple features to spatstat’s ppp (planar point pattern) object</strong></a></li>
  <li><a href="#handling-duplicated-points" id="toc-handling-duplicated-points" class="nav-link" data-scroll-target="#handling-duplicated-points"><strong>5.1.5 Handling duplicated points</strong></a></li>
  <li><a href="#creating-owin-object" id="toc-creating-owin-object" class="nav-link" data-scroll-target="#creating-owin-object"><strong>5.1.6 Creating <em>owin</em> object</strong></a></li>
  <li><a href="#creating-point-events-objects-in-owin-object" id="toc-creating-point-events-objects-in-owin-object" class="nav-link" data-scroll-target="#creating-point-events-objects-in-owin-object"><strong>5.1.7 Creating point events objects in <em>owin</em> Object</strong></a></li>
  </ul></li>
  <li><a href="#stkde" id="toc-stkde" class="nav-link" data-scroll-target="#stkde">5.2 STKDE</a>
  <ul class="collapse">
  <li><a href="#extracting-the-data-by-quarter" id="toc-extracting-the-data-by-quarter" class="nav-link" data-scroll-target="#extracting-the-data-by-quarter"><strong>5.2.1 Extracting the data by quarter</strong></a></li>
  <li><a href="#converting-the-simple-features-to-spatstats-ppp-object." id="toc-converting-the-simple-features-to-spatstats-ppp-object." class="nav-link" data-scroll-target="#converting-the-simple-features-to-spatstats-ppp-object."><strong>5.2.2 Converting the simple features to spatstat’s ppp object</strong>.</a></li>
  <li><a href="#handling-duplicated-points-1" id="toc-handling-duplicated-points-1" class="nav-link" data-scroll-target="#handling-duplicated-points-1"><strong>5.2.3 Handling duplicated points</strong></a></li>
  <li><a href="#creating-point-events-objects-in-owin-object-1" id="toc-creating-point-events-objects-in-owin-object-1" class="nav-link" data-scroll-target="#creating-point-events-objects-in-owin-object-1"><strong>5.2.4 Creating point events objects in <em>owin</em> Object</strong></a></li>
  </ul></li>
  <li><a href="#openstreetmap" id="toc-openstreetmap" class="nav-link" data-scroll-target="#openstreetmap"><strong>5.3 OpenStreetMap</strong></a>
  <ul class="collapse">
  <li><a href="#data-clean-up" id="toc-data-clean-up" class="nav-link" data-scroll-target="#data-clean-up"><strong>5.3.1 Data clean up</strong></a></li>
  <li><a href="#merging-osm-and-sf" id="toc-merging-osm-and-sf" class="nav-link" data-scroll-target="#merging-osm-and-sf"><strong>5.3.2 Merging osm and sf</strong></a></li>
  </ul></li>
  </ul></li>
  <li><a href="#first-order-spatial-point-patterns-analysis" id="toc-first-order-spatial-point-patterns-analysis" class="nav-link" data-scroll-target="#first-order-spatial-point-patterns-analysis"><strong>6 First-order Spatial Point Patterns Analysis</strong></a>
  <ul class="collapse">
  <li><a href="#kernel-density-estimation" id="toc-kernel-density-estimation" class="nav-link" data-scroll-target="#kernel-density-estimation"><strong>6.1 Kernel Density Estimation</strong></a>
  <ul class="collapse">
  <li><a href="#rescaling-kde-layers" id="toc-rescaling-kde-layers" class="nav-link" data-scroll-target="#rescaling-kde-layers"><strong>6.1.1 Rescaling KDE Layers</strong></a></li>
  <li><a href="#quarterly-kde-layers" id="toc-quarterly-kde-layers" class="nav-link" data-scroll-target="#quarterly-kde-layers">6.1.2 Quarterly KDE layers</a></li>
  <li><a href="#quarterly-spatio-temporal-kde-layers" id="toc-quarterly-spatio-temporal-kde-layers" class="nav-link" data-scroll-target="#quarterly-spatio-temporal-kde-layers">6.1.3 Quarterly spatio-temporal KDE layers</a></li>
  <li><a href="#openstreetmap-1" id="toc-openstreetmap-1" class="nav-link" data-scroll-target="#openstreetmap-1">6.1.4 OpenStreetMap</a></li>
  <li><a href="#interpretations" id="toc-interpretations" class="nav-link" data-scroll-target="#interpretations">6.1.5 Interpretations</a></li>
  </ul></li>
  </ul></li>
  <li><a href="#second-order-analysis" id="toc-second-order-analysis" class="nav-link" data-scroll-target="#second-order-analysis">7 Second-order analysis</a>
  <ul class="collapse">
  <li><a href="#second-order-analysis-data-wrangling" id="toc-second-order-analysis-data-wrangling" class="nav-link" data-scroll-target="#second-order-analysis-data-wrangling"><strong>7.1 Second-order analysis Data Wrangling</strong></a></li>
  <li><a href="#g-function-for-spatial-point-process-analysis" id="toc-g-function-for-spatial-point-process-analysis" class="nav-link" data-scroll-target="#g-function-for-spatial-point-process-analysis"><strong>7.2 G-Function for Spatial Point Process Analysis</strong></a>
  <ul class="collapse">
  <li><a href="#magway-area" id="toc-magway-area" class="nav-link" data-scroll-target="#magway-area">7.2.1 Magway area</a></li>
  <li><a href="#sagaing-area" id="toc-sagaing-area" class="nav-link" data-scroll-target="#sagaing-area">7.2.2 Sagaing area</a></li>
  <li><a href="#mandalay-area" id="toc-mandalay-area" class="nav-link" data-scroll-target="#mandalay-area">7.2.3 Mandalay area</a></li>
  <li><a href="#interpretation-of-g-function" id="toc-interpretation-of-g-function" class="nav-link" data-scroll-target="#interpretation-of-g-function">7.2.4 Interpretation of G-Function</a></li>
  </ul></li>
  </ul></li>
  <li><a href="#conclusion" id="toc-conclusion" class="nav-link" data-scroll-target="#conclusion">8 Conclusion</a></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">Take-home_Ex01</h1>
</div>



<div class="quarto-title-meta">

    <div>
    <div class="quarto-title-meta-heading">Author</div>
    <div class="quarto-title-meta-contents">
             <p>Ryan Peh </p>
          </div>
  </div>
    
    <div>
    <div class="quarto-title-meta-heading">Published</div>
    <div class="quarto-title-meta-contents">
      <p class="date">September 7, 2030</p>
    </div>
  </div>
  
    <div>
    <div class="quarto-title-meta-heading">Modified</div>
    <div class="quarto-title-meta-contents">
      <p class="date-modified">September 30, 2024</p>
    </div>
  </div>
    
  </div>
  


</header>


<section id="overview" class="level1">
<h1><strong>1 Overview</strong></h1>
<section id="objective" class="level2">
<h2 class="anchored" data-anchor-id="objective"><strong>1.1 Objective</strong></h2>
<p>To apply spatial point patterns analysis methods to discover the spatial and spatio-temporal distribution of armed conflict in Myanmar.</p>
</section>
<section id="background" class="level2">
<h2 class="anchored" data-anchor-id="background">1.2 Background</h2>
</section>
</section>
<section id="setup" class="level1">
<h1><strong>2 Setup</strong></h1>
<section id="data" class="level2">
<h2 class="anchored" data-anchor-id="data"><strong>2.1 Data</strong></h2>
<ul>
<li><p>For the purpose of this assignment, armed conflict data of Myanmar between 2021-2024 from <a href="https://acleddata.com/">Armed Conflict Location &amp; Event Data (ACLED)</a>, an independent, impartial, international non-profit organization collecting data on violent conflict and protest in all countries and territories in the world, should be used.</p>
<p>In terms of event types, students should focus on at least four main event types, namely: Battles, Explosion/Remote violence, Strategic developments, and Violence against civilians.</p>
<p>In terms of study period, students should focus on quarterly armed conflict events from January 2021 until June 2024.</p></li>
<li><p><a href="http://geonode.themimu.info/layers/?limit=100&amp;offset=0">Geospatial data</a> on <a href="http://www.themimu.info/">Myanmar Information Management Unit, MIMU</a></p></li>
<li><p>Myanmar <a href="https://download.geofabrik.de/asia/myanmar.html">OpenStreetMap</a></p></li>
</ul>
</section>
</section>
<section id="the-task" class="level1">
<h1><strong>3 The Task</strong></h1>
<p>The specific tasks of this take-home exercise are as follows:</p>
<ul>
<li><p>Using appropriate function of <strong>sf</strong> and <strong>tidyverse</strong> packages, import and transform the downloaded armed conflict data and administrative boundary data into sf tibble data.frames.</p></li>
<li><p>Using the geospatial data sets prepared, derive quarterly KDE layers.</p></li>
<li><p>Using the geospatial data sets prepared, perform 2nd-Order Spatial Point Patterns Analysis.</p></li>
<li><p>Using the geospatial data sets prepared, derive quarterly spatio-temporal KDE layers.</p></li>
<li><p>Using the geospatial data sets prepared, perform 2nd-Order Spatio-temporal Point Patterns Analysis.</p></li>
<li><p>Using appropriate <strong>tmap</strong> functions, display the KDE and Spatio-temporal KDE layers on openstreetmap of Myanmar.</p></li>
<li><p>Describe the spatial patterns revealed by the KDE and Spatio-temporal KDE maps.</p></li>
</ul>
</section>
<section id="data-preparation" class="level1">
<h1><strong>4 Data preparation</strong></h1>
<section id="importing-packages" class="level2">
<h2 class="anchored" data-anchor-id="importing-packages"><strong>4.1 Importing packages</strong></h2>
<p>Before starting the exercise, we need to import the necessary R packages. The following packages will be used:</p>
<ul>
<li><strong>tmap</strong>: Used for creating static and interactive visualizations, including summary statistics and KDE layers.</li>
<li><strong>sf</strong>: Provides a standardized way to encode spatial vector data in the R environment, facilitating spatial data operations and analysis.</li>
<li><strong>st</strong>: Creates simple features from numeric vectors, matrices, or lists, enabling the representation and manipulation of spatial structures in R.</li>
<li><strong>spatstat</strong>: A package for statistical analysis of spatial data, particularly for Spatial Point Pattern Analysis. Developed by Baddeley, Turner, and Ruback (2015), it offers a comprehensive set of functions for first- and second-order spatial point pattern analysis and kernel density estimation (KDE).</li>
<li><strong>tidyverse</strong>: A collection of R packages designed for data science, all sharing a consistent design philosophy, grammar, and data structure.</li>
<li><strong>raster</strong>: Facilitates reading, writing, manipulating, analyzing, and modeling gridded spatial data (i.e., raster). In this exercise, it will be used to convert image outputs generated by spatstat into raster format.</li>
<li><strong>lubridate</strong>: Helps to split data into quarters based on their respective years.</li>
<li><strong>sparr</strong>: A package used for spatial and spatio-temporal kernel density estimation (STKDE). It provides methods for analyzing point patterns in space and time, helping to identify hotspots and spatial clustering over time. In this exercise, it is employed to perform spatio-temporal density analysis using the <code>spattemp.density</code> function.</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a>pacman<span class="sc">::</span><span class="fu">p_load</span>(tmap, sf, tidyverse, raster, spatstat, sp, lubridate, sparr)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="importing-datasets" class="level2">
<h2 class="anchored" data-anchor-id="importing-datasets"><strong>4.2 Importing datasets</strong></h2>
<section id="geospatial-data" class="level3">
<h3 class="anchored" data-anchor-id="geospatial-data"><strong>4.2.1 Geospatial Data</strong></h3>
<p>The following code chunk uses the <code>st_read()</code> function from the <code>sf</code> package to import the Myanmar shapefile into R. The imported shapefile will be an sf object, representing simple features for spatial analysis.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a>myanmar_sf <span class="ot">&lt;-</span> <span class="fu">st_read</span>(<span class="at">dsn =</span> <span class="st">"data/raw/geospatial"</span>, </span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a>                 <span class="at">layer =</span> <span class="st">"mmr_polbnda_adm1_250k_mimu_1"</span>)<span class="sc">%&gt;%</span></span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">st_transform</span>(<span class="at">crs =</span> <span class="dv">32647</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Reading layer `mmr_polbnda_adm1_250k_mimu_1' from data source 
  `C:\ryanpxp\IS415-GAA\Take-home_Ex\Take-home_Ex01\data\raw\geospatial' 
  using driver `ESRI Shapefile'
Simple feature collection with 15 features and 6 fields
Geometry type: MULTIPOLYGON
Dimension:     XY
Bounding box:  xmin: 92.1721 ymin: 9.696844 xmax: 101.17 ymax: 28.54554
Geodetic CRS:  WGS 84</code></pre>
</div>
</div>
</section>
<section id="aspatial-data" class="level3">
<h3 class="anchored" data-anchor-id="aspatial-data"><strong>4.2.2 Aspatial Data</strong></h3>
<p>The dataset obtained from ACLED is in CSV format. To work with this data in R, we need to import it as an sf object using the <code>st_read()</code> function from the <code>sf</code> package. This function processes the CSV data and produces an sf object for further analysis.</p>
<p>Since we require coordinates and date is not in a useful format to us, we make adjustments accordingly.Moreover, the data has been adjusted to ensure the EPSG coordinates are precise for Myanmar.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a>conflict_sf <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(<span class="st">"data/raw/ACLED_Myanmar_2021_2024.csv"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">event_date =</span> <span class="fu">dmy</span>(event_date)) <span class="sc">%&gt;%</span></span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">st_as_sf</span>(<span class="at">coords =</span> <span class="fu">c</span>(<span class="st">"longitude"</span>, <span class="st">"latitude"</span>),</span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true" tabindex="-1"></a>                       <span class="at">crs =</span> <span class="dv">4326</span>)<span class="sc">%&gt;%</span></span>
<span id="cb4-5"><a href="#cb4-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">st_transform</span>(<span class="at">crs =</span> <span class="dv">32647</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="openstreetmap-data" class="level3">
<h3 class="anchored" data-anchor-id="openstreetmap-data"><strong>4.2.3 OpenStreetMap Data</strong></h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a>osm <span class="ot">=</span> <span class="fu">st_read</span>(<span class="st">"data/raw/myanmar-osm.shp.zip"</span>, <span class="at">layer=</span><span class="st">"gis_osm_roads_free_1"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Reading layer `gis_osm_roads_free_1' from data source 
  `C:\ryanpxp\IS415-GAA\Take-home_Ex\Take-home_Ex01\data\raw\myanmar-osm.shp.zip' 
  using driver `ESRI Shapefile'
Simple feature collection with 569243 features and 10 fields
Geometry type: LINESTRING
Dimension:     XY
Bounding box:  xmin: 92.13721 ymin: 9.783255 xmax: 101.2285 ymax: 28.37868
Geodetic CRS:  WGS 84</code></pre>
</div>
</div>
</section>
</section>
</section>
<section id="data-wrangling" class="level1">
<h1><strong>5 Data Wrangling</strong></h1>
<section id="kde" class="level2">
<h2 class="anchored" data-anchor-id="kde">5.1 KDE</h2>
<section id="adding-columns-for-quarters" class="level3">
<h3 class="anchored" data-anchor-id="adding-columns-for-quarters"><strong>5.1.1 Adding columns for quarters</strong></h3>
<p>Adding decimal format of quarters for division of datsets later and quarter formatted string “YYYYQX” for presentation. Quarter sequence in the from of numbers 1 to 14 to represent 2021Q1, 2021Q2, … to 2024Q2 for STKDE analysis later.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a>conflict_sf <span class="ot">&lt;-</span> conflict_sf <span class="sc">%&gt;%</span> </span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">DayofYear =</span> <span class="fu">yday</span>(event_date)) <span class="sc">%&gt;%</span></span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Month_num =</span> <span class="fu">month</span>(event_date)) <span class="sc">%&gt;%</span></span>
<span id="cb7-4"><a href="#cb7-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Month_fac =</span> <span class="fu">month</span>(event_date, </span>
<span id="cb7-5"><a href="#cb7-5" aria-hidden="true" tabindex="-1"></a>                           <span class="at">label =</span> <span class="cn">TRUE</span>, </span>
<span id="cb7-6"><a href="#cb7-6" aria-hidden="true" tabindex="-1"></a>                           <span class="at">abbr =</span> <span class="cn">FALSE</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb7-7"><a href="#cb7-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Quarter_decimal =</span> <span class="fu">quarter</span>(event_date)) <span class="sc">%&gt;%</span></span>
<span id="cb7-8"><a href="#cb7-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Quarter_label =</span> <span class="fu">paste</span>(<span class="fu">year</span>(event_date), <span class="st">"Q"</span>, <span class="fu">quarter</span>(event_date), <span class="at">sep =</span> <span class="st">""</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb7-9"><a href="#cb7-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Quarter_sequence =</span> (<span class="fu">year</span>(event_date) <span class="sc">-</span> <span class="dv">2021</span>) <span class="sc">*</span> <span class="dv">4</span> <span class="sc">+</span> <span class="fu">quarter</span>(event_date))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Rds is written for future readings:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="fu">write_rds</span>(conflict_sf, <span class="st">"data/rds/myanmar_conflict.rds"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a>conflict_sf <span class="ot">&lt;-</span> <span class="fu">read_rds</span>(<span class="st">"data/rds/myanmar_conflict.rds"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Plot to give a sense of data:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="fu">tm_shape</span>(myanmar_sf)<span class="sc">+</span></span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_polygons</span>() <span class="sc">+</span></span>
<span id="cb10-3"><a href="#cb10-3" aria-hidden="true" tabindex="-1"></a><span class="fu">tm_shape</span>(conflict_sf) <span class="sc">+</span></span>
<span id="cb10-4"><a href="#cb10-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_dots</span>() <span class="sc">+</span></span>
<span id="cb10-5"><a href="#cb10-5" aria-hidden="true" tabindex="-1"></a><span class="fu">tm_facets</span>(<span class="at">by=</span><span class="st">"Quarter_label"</span>, </span>
<span id="cb10-6"><a href="#cb10-6" aria-hidden="true" tabindex="-1"></a>            <span class="at">free.coords=</span><span class="cn">FALSE</span>, </span>
<span id="cb10-7"><a href="#cb10-7" aria-hidden="true" tabindex="-1"></a>            <span class="at">drop.units =</span> <span class="cn">TRUE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Take-home_Ex01_files/figure-html/unnamed-chunk-8-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="separating-the-data-by-year-and-quarter" class="level3">
<h3 class="anchored" data-anchor-id="separating-the-data-by-year-and-quarter"><strong>5.1.2 Separating the data by year and quarter</strong></h3>
<p>The code chunk below separates the data provided into year and quarter for easier plotting.</p>
<p>A list is created to store the filtered data by year and quarter and is flatten to change from a list of 4 items with another 4 nested items each to a list of 16 items. Names were then assigned to these items in the list so that it will be more intuitive to retrieve the required sf than just calling a number.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Define years and quarters</span></span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a>years <span class="ot">&lt;-</span> <span class="dv">2021</span><span class="sc">:</span><span class="dv">2024</span></span>
<span id="cb11-3"><a href="#cb11-3" aria-hidden="true" tabindex="-1"></a>quarters <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">4</span></span>
<span id="cb11-4"><a href="#cb11-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-5"><a href="#cb11-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Create a list to store the filtered data</span></span>
<span id="cb11-6"><a href="#cb11-6" aria-hidden="true" tabindex="-1"></a>conflict_list <span class="ot">&lt;-</span> <span class="fu">map</span>(years, <span class="cf">function</span>(yr) {</span>
<span id="cb11-7"><a href="#cb11-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">map</span>(quarters, <span class="cf">function</span>(qtr) {</span>
<span id="cb11-8"><a href="#cb11-8" aria-hidden="true" tabindex="-1"></a>    conflict_sf <span class="sc">%&gt;%</span></span>
<span id="cb11-9"><a href="#cb11-9" aria-hidden="true" tabindex="-1"></a>      <span class="fu">filter</span>(year <span class="sc">==</span> yr, Quarter_decimal <span class="sc">==</span> qtr)</span>
<span id="cb11-10"><a href="#cb11-10" aria-hidden="true" tabindex="-1"></a>  })</span>
<span id="cb11-11"><a href="#cb11-11" aria-hidden="true" tabindex="-1"></a>})<span class="sc">%&gt;%</span></span>
<span id="cb11-12"><a href="#cb11-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">flatten</span>() <span class="co"># Flatten the list to remove nested structure</span></span>
<span id="cb11-13"><a href="#cb11-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-14"><a href="#cb11-14" aria-hidden="true" tabindex="-1"></a><span class="co"># give names to the list items</span></span>
<span id="cb11-15"><a href="#cb11-15" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(conflict_list) <span class="ot">&lt;-</span> <span class="fu">map</span>(years, <span class="cf">function</span>(yr) {</span>
<span id="cb11-16"><a href="#cb11-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">map</span>(quarters, <span class="cf">function</span>(qtr) {</span>
<span id="cb11-17"><a href="#cb11-17" aria-hidden="true" tabindex="-1"></a>    <span class="fu">paste0</span>(<span class="st">"conflict_"</span>, yr, <span class="st">".Q"</span>, qtr, <span class="st">"_sf"</span>)</span>
<span id="cb11-18"><a href="#cb11-18" aria-hidden="true" tabindex="-1"></a>  })</span>
<span id="cb11-19"><a href="#cb11-19" aria-hidden="true" tabindex="-1"></a>}) <span class="sc">%&gt;%</span></span>
<span id="cb11-20"><a href="#cb11-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">unlist</span>() <span class="co"># Unlist to match the flattened structure</span></span>
<span id="cb11-21"><a href="#cb11-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-22"><a href="#cb11-22" aria-hidden="true" tabindex="-1"></a><span class="co"># Remove specific problematic entries for 2024 Q3 and Q4</span></span>
<span id="cb11-23"><a href="#cb11-23" aria-hidden="true" tabindex="-1"></a>conflict_list <span class="ot">&lt;-</span> conflict_list[<span class="sc">!</span><span class="fu">names</span>(conflict_list) <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">"conflict_2024.Q3_sf"</span>, <span class="st">"conflict_2024.Q4_sf"</span>)]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>In order to read the sf of 2021 q1:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a>conflict_list[[<span class="st">"conflict_2021.Q1_sf"</span>]]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Simple feature collection with 4843 features and 32 fields
Geometry type: POINT
Dimension:     XY
Bounding box:  xmin: -203795.3 ymin: 1103500 xmax: 591875.9 ymax: 3042960
Projected CRS: WGS 84 / UTM zone 47N
# A tibble: 4,843 × 33
   event_id_cnty event_date  year time_precision disorder_type        event_type
 * &lt;chr&gt;         &lt;date&gt;     &lt;dbl&gt;          &lt;dbl&gt; &lt;chr&gt;                &lt;chr&gt;     
 1 MMR14614      2021-03-31  2021              1 Political violence   Explosion…
 2 MMR14614      2021-03-31  2021              1 Political violence   Explosion…
 3 MMR14632      2021-03-31  2021              1 Strategic developme… Strategic…
 4 MMR14632      2021-03-31  2021              1 Strategic developme… Strategic…
 5 MMR14625      2021-03-31  2021              1 Political violence   Battles   
 6 MMR14625      2021-03-31  2021              1 Political violence   Battles   
 7 MMR14609      2021-03-31  2021              1 Political violence   Violence …
 8 MMR14609      2021-03-31  2021              1 Political violence   Violence …
 9 MMR14618      2021-03-31  2021              1 Strategic developme… Strategic…
10 MMR14653      2021-03-31  2021              1 Political violence   Violence …
# ℹ 4,833 more rows
# ℹ 27 more variables: sub_event_type &lt;chr&gt;, actor1 &lt;chr&gt;, assoc_actor_1 &lt;chr&gt;,
#   inter1 &lt;dbl&gt;, interaction &lt;dbl&gt;, civilian_targeting &lt;chr&gt;, iso &lt;dbl&gt;,
#   region &lt;chr&gt;, country &lt;chr&gt;, admin1 &lt;chr&gt;, admin2 &lt;chr&gt;, admin3 &lt;chr&gt;,
#   location &lt;chr&gt;, geo_precision &lt;dbl&gt;, source &lt;chr&gt;, source_scale &lt;chr&gt;,
#   notes &lt;chr&gt;, fatalities &lt;dbl&gt;, tags &lt;chr&gt;, timestamp &lt;dbl&gt;,
#   geometry &lt;POINT [m]&gt;, DayofYear &lt;dbl&gt;, Month_num &lt;dbl&gt;, Month_fac &lt;ord&gt;, …</code></pre>
</div>
</div>
</section>
<section id="converting-sf-data-frames-to-sps-spatial-class" class="level3">
<h3 class="anchored" data-anchor-id="converting-sf-data-frames-to-sps-spatial-class"><strong>5.1.3 Converting sf data frames to sp’s Spatial* class</strong></h3>
<p>The code chunk below uses <a href="https://r4gdsa.netlify.app/chap04.html?q=KDE%20layers"><em>as_Spatial()</em></a> of <strong>sf</strong> package to convert the geospatial data from simple feature data frame to sp’s Spatial* class.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Overall</span></span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a>conflict_sp <span class="ot">&lt;-</span> <span class="fu">as_Spatial</span>(conflict_sf)</span>
<span id="cb14-3"><a href="#cb14-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-4"><a href="#cb14-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Convert all sf objects to Spatial objects using map</span></span>
<span id="cb14-5"><a href="#cb14-5" aria-hidden="true" tabindex="-1"></a>conflict_sp_list <span class="ot">&lt;-</span> <span class="fu">map</span>(conflict_list, as_Spatial)</span>
<span id="cb14-6"><a href="#cb14-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-7"><a href="#cb14-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Give meaningful names to the list elements</span></span>
<span id="cb14-8"><a href="#cb14-8" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(conflict_sp_list) <span class="ot">&lt;-</span> <span class="fu">c</span>(</span>
<span id="cb14-9"><a href="#cb14-9" aria-hidden="true" tabindex="-1"></a>  <span class="st">"conflict_2021.Q1"</span>, <span class="st">"conflict_2021.Q2"</span>, <span class="st">"conflict_2021.Q3"</span>, <span class="st">"conflict_2021.Q4"</span>,</span>
<span id="cb14-10"><a href="#cb14-10" aria-hidden="true" tabindex="-1"></a>  <span class="st">"conflict_2022.Q1"</span>, <span class="st">"conflict_2022.Q2"</span>, <span class="st">"conflict_2022.Q3"</span>, <span class="st">"conflict_2022.Q4"</span>,</span>
<span id="cb14-11"><a href="#cb14-11" aria-hidden="true" tabindex="-1"></a>  <span class="st">"conflict_2023.Q1"</span>, <span class="st">"conflict_2023.Q2"</span>, <span class="st">"conflict_2023.Q3"</span>, <span class="st">"conflict_2023.Q4"</span>,</span>
<span id="cb14-12"><a href="#cb14-12" aria-hidden="true" tabindex="-1"></a>  <span class="st">"conflict_2024.Q1"</span>, <span class="st">"conflict_2024.Q2"</span></span>
<span id="cb14-13"><a href="#cb14-13" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>In order to read 2021 q1:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a>conflict_sp_list[[<span class="st">"conflict_2021.Q1"</span>]]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>class       : SpatialPointsDataFrame 
features    : 4843 
extent      : -203795.3, 591875.9, 1103500, 3042960  (xmin, xmax, ymin, ymax)
crs         : +proj=utm +zone=47 +datum=WGS84 +units=m +no_defs 
variables   : 32
names       : event_id_cnty, event_date, year, time_precision,          disorder_type,                 event_type,                 sub_event_type,                                     actor1,                                                                                                     assoc_actor_1, inter1, interaction, civilian_targeting, iso,         region, country, ... 
min values  :      MMR10890,      18628, 2021,              1,         Demonstrations,                    Battles, Abduction/forced disappearance,       ARSA: Arakan Rohingya Salvation Army, 88 Generation Peace and Open Society; Buddhist Group (Myanmar); Government of Myanmar (2016-); Students (Myanmar),      1,          10, Civilian targeting, 104, Southeast Asia, Myanmar, ... 
max values  :      MMR62411,      18717, 2021,              3, Strategic developments, Violence against civilians,          Violent demonstration, YURF: Yadanarbon Urban Revolutionary Front,                                                                  Women (Myanmar); Rohingya Muslim Group (Myanmar),      7,          70, Civilian targeting, 104, Southeast Asia, Myanmar, ... </code></pre>
</div>
</div>
</section>
<section id="converting-the-simple-features-to-spatstats-ppp-planar-point-pattern-object" class="level3">
<h3 class="anchored" data-anchor-id="converting-the-simple-features-to-spatstats-ppp-planar-point-pattern-object"><strong>5.1.4 Converting the simple features to spatstat’s ppp (planar point pattern) object</strong></h3>
<p><strong>spatstat</strong>&nbsp;requires the analytical data in <strong><em>ppp</em></strong> object form. Hence we will convert <code>sf</code> objects to <code>ppp</code> objects using <strong>as.ppp()</strong> function by providing the point coordinates and the observation window.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a><span class="co"># overall</span></span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a>conflict_ppp <span class="ot">&lt;-</span> <span class="fu">as.ppp</span>(<span class="fu">st_coordinates</span>(conflict_sf), <span class="fu">st_bbox</span>(conflict_sf))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: data contain duplicated points</code></pre>
</div>
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Create names for the resulting ppp objects</span></span>
<span id="cb19-2"><a href="#cb19-2" aria-hidden="true" tabindex="-1"></a>ppp_names <span class="ot">&lt;-</span> <span class="fu">paste0</span>(<span class="fu">rep</span>(years, <span class="at">each =</span> <span class="dv">4</span>), <span class="st">".Q"</span>, <span class="fu">rep</span>(quarters, <span class="fu">length</span>(years)))</span>
<span id="cb19-3"><a href="#cb19-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Remove the last two names (2024q3 and 2024q4)</span></span>
<span id="cb19-4"><a href="#cb19-4" aria-hidden="true" tabindex="-1"></a>ppp_names <span class="ot">&lt;-</span> ppp_names[<span class="dv">1</span><span class="sc">:</span>(<span class="fu">length</span>(ppp_names) <span class="sc">-</span> <span class="dv">2</span>)]</span>
<span id="cb19-5"><a href="#cb19-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-6"><a href="#cb19-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Apply the conversion using map2 from purrr and assign the results dynamically</span></span>
<span id="cb19-7"><a href="#cb19-7" aria-hidden="true" tabindex="-1"></a>conflict_ppp_list <span class="ot">&lt;-</span> <span class="fu">map</span>(conflict_list, <span class="sc">~</span> <span class="fu">as.ppp</span>(<span class="fu">st_coordinates</span>(.x), <span class="fu">st_bbox</span>(.x)))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: data contain duplicated points
Warning: data contain duplicated points
Warning: data contain duplicated points
Warning: data contain duplicated points
Warning: data contain duplicated points
Warning: data contain duplicated points
Warning: data contain duplicated points
Warning: data contain duplicated points
Warning: data contain duplicated points
Warning: data contain duplicated points
Warning: data contain duplicated points
Warning: data contain duplicated points
Warning: data contain duplicated points
Warning: data contain duplicated points</code></pre>
</div>
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Assign names to the ppp list</span></span>
<span id="cb21-2"><a href="#cb21-2" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(conflict_ppp_list) <span class="ot">&lt;-</span> ppp_names</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Quick look at the new ppp object:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb22"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(conflict_ppp_list[[<span class="st">"2021.Q2"</span>]], <span class="at">main =</span> <span class="st">"2021.Q2"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Take-home_Ex01_files/figure-html/unnamed-chunk-14-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>The summary statistics of a newly created ppp object:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb23"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(conflict_ppp_list[[<span class="st">"2021.Q2"</span>]])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Planar point pattern:  7017 points
Average intensity 4.412701e-09 points per square unit

*Pattern contains duplicated points*

Coordinates are given to 13 decimal places

Window: rectangle = [-191409.1, 640934.5] x [1132472.1, 3042960.3] units
                    (832300 x 1910000 units)
Window area = 1.59018e+12 square units</code></pre>
</div>
</div>
</section>
<section id="handling-duplicated-points" class="level3">
<h3 class="anchored" data-anchor-id="handling-duplicated-points"><strong>5.1.5 Handling duplicated points</strong></h3>
<p>It is previously mentioned in <code>summary(acled_ppp)</code> that there are duplicated points in the patterns. Duplication in <strong><em>ppp</em></strong> object can be confirmed by using the code chunk below.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb25"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a><span class="fu">any</span>(<span class="fu">duplicated</span>(conflict_ppp_list[[<span class="st">"2021.Q2"</span>]]))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] TRUE</code></pre>
</div>
</div>
<p>We can address this by using <code>rjitter()</code> which will add a small perturbation to the duplicate points so that they do not occupy the exact same spaces.</p>
<p>A function was declared to apply <code>rjitter()</code> to all the items in the list.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb27"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a><span class="co"># overall</span></span>
<span id="cb27-2"><a href="#cb27-2" aria-hidden="true" tabindex="-1"></a>conflict_ppp_jit <span class="ot">&lt;-</span> <span class="fu">rjitter</span>(conflict_ppp, </span>
<span id="cb27-3"><a href="#cb27-3" aria-hidden="true" tabindex="-1"></a>                             <span class="at">retry=</span><span class="cn">TRUE</span>, </span>
<span id="cb27-4"><a href="#cb27-4" aria-hidden="true" tabindex="-1"></a>                             <span class="at">nsim=</span><span class="dv">1</span>, </span>
<span id="cb27-5"><a href="#cb27-5" aria-hidden="true" tabindex="-1"></a>                             <span class="at">drop=</span><span class="cn">TRUE</span>)</span>
<span id="cb27-6"><a href="#cb27-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-7"><a href="#cb27-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Define a function to apply rjitter to each ppp object</span></span>
<span id="cb27-8"><a href="#cb27-8" aria-hidden="true" tabindex="-1"></a>jitter_conflict_ppp_func <span class="ot">&lt;-</span> <span class="cf">function</span>(ppp) {</span>
<span id="cb27-9"><a href="#cb27-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rjitter</span>(ppp, <span class="at">retry =</span> <span class="cn">TRUE</span>, <span class="at">nsim =</span> <span class="dv">1</span>, <span class="at">drop =</span> <span class="cn">TRUE</span>)</span>
<span id="cb27-10"><a href="#cb27-10" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb27-11"><a href="#cb27-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-12"><a href="#cb27-12" aria-hidden="true" tabindex="-1"></a><span class="co"># Apply jittering to all ppp objects</span></span>
<span id="cb27-13"><a href="#cb27-13" aria-hidden="true" tabindex="-1"></a>jittered_ppp_list <span class="ot">&lt;-</span> <span class="fu">map</span>(conflict_ppp_list, jitter_conflict_ppp_func)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Confirm if there is still any duplicate points:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb28"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a><span class="fu">any</span>(<span class="fu">duplicated</span>(jittered_ppp_list[[<span class="st">"2021.Q1"</span>]]))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] FALSE</code></pre>
</div>
</div>
</section>
<section id="creating-owin-object" class="level3">
<h3 class="anchored" data-anchor-id="creating-owin-object"><strong>5.1.6 Creating <em>owin</em> object</strong></h3>
<p>Conversion of the <code>myanmar_sf</code> object into an <code>owin</code> object.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb30"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a>myanmar_owin <span class="ot">&lt;-</span> <span class="fu">as.owin</span>(myanmar_sf)</span>
<span id="cb30-2"><a href="#cb30-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(myanmar_owin)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Take-home_Ex01_files/figure-html/unnamed-chunk-19-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb31"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(myanmar_owin)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="creating-point-events-objects-in-owin-object" class="level3">
<h3 class="anchored" data-anchor-id="creating-point-events-objects-in-owin-object"><strong>5.1.7 Creating point events objects in <em>owin</em> Object</strong></h3>
<p>Create point events in <em>owin</em> Object after jittering the duplications.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb32"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true" tabindex="-1"></a><span class="co"># overall</span></span>
<span id="cb32-2"><a href="#cb32-2" aria-hidden="true" tabindex="-1"></a>conflictmyanmar_ppp <span class="ot">=</span> conflict_ppp_jit[myanmar_owin]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb33"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb33-1"><a href="#cb33-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Define a function to merge ppp and owin object</span></span>
<span id="cb33-2"><a href="#cb33-2" aria-hidden="true" tabindex="-1"></a>merge_ppp_owin_func <span class="ot">&lt;-</span> <span class="cf">function</span>(ppp, owin) {</span>
<span id="cb33-3"><a href="#cb33-3" aria-hidden="true" tabindex="-1"></a>  ppp[owin]</span>
<span id="cb33-4"><a href="#cb33-4" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb33-5"><a href="#cb33-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-6"><a href="#cb33-6" aria-hidden="true" tabindex="-1"></a>conflictmyanmar_ppp_list <span class="ot">&lt;-</span> <span class="fu">map</span>(jittered_ppp_list, <span class="sc">~</span> <span class="fu">merge_ppp_owin_func</span>(.x, myanmar_owin))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Object combines both the point and polygon feature in one <code>ppp</code> object class.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb34"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(conflictmyanmar_ppp_list[[<span class="st">"2021.Q1"</span>]])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb35"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb35-1"><a href="#cb35-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(conflictmyanmar_ppp_list[[<span class="st">"2021.Q1"</span>]], <span class="at">main =</span> <span class="st">"Myanmar Q1 2021"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Take-home_Ex01_files/figure-html/unnamed-chunk-24-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
</section>
<section id="stkde" class="level2">
<h2 class="anchored" data-anchor-id="stkde">5.2 STKDE</h2>
<section id="extracting-the-data-by-quarter" class="level3">
<h3 class="anchored" data-anchor-id="extracting-the-data-by-quarter"><strong>5.2.1 Extracting the data by quarter</strong></h3>
<p>To prepare the <strong>sf</strong> object for STKDE, the Quarter_sequence was extracted from the <strong>sf</strong> object.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb36"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb36-1"><a href="#cb36-1" aria-hidden="true" tabindex="-1"></a>conflict_quarterly <span class="ot">&lt;-</span> conflict_sf <span class="sc">%&gt;%</span> </span>
<span id="cb36-2"><a href="#cb36-2" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(Quarter_sequence)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="converting-the-simple-features-to-spatstats-ppp-object." class="level3">
<h3 class="anchored" data-anchor-id="converting-the-simple-features-to-spatstats-ppp-object."><strong>5.2.2 Converting the simple features to spatstat’s ppp object</strong>.</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb37"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb37-1"><a href="#cb37-1" aria-hidden="true" tabindex="-1"></a>conflict_quarterly_ppp <span class="ot">&lt;-</span> <span class="fu">as.ppp</span>(conflict_quarterly)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="handling-duplicated-points-1" class="level3">
<h3 class="anchored" data-anchor-id="handling-duplicated-points-1"><strong>5.2.3 Handling duplicated points</strong></h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb38"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb38-1"><a href="#cb38-1" aria-hidden="true" tabindex="-1"></a><span class="fu">any</span>(<span class="fu">duplicated</span>(conflict_quarterly_ppp))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] TRUE</code></pre>
</div>
</div>
<p>Confirmation of the existence of duplicates, use <code>rjitter()</code>to remove duplicates.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb40"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb40-1"><a href="#cb40-1" aria-hidden="true" tabindex="-1"></a>conflict_quarterly_ppp <span class="ot">&lt;-</span> <span class="fu">rjitter</span>(conflict_quarterly_ppp, <span class="at">retry =</span> <span class="cn">TRUE</span>, <span class="at">nsimm =</span> <span class="dv">1</span>, <span class="at">drop =</span> <span class="cn">TRUE</span>)</span>
<span id="cb40-2"><a href="#cb40-2" aria-hidden="true" tabindex="-1"></a><span class="fu">any</span>(<span class="fu">duplicated</span>(conflict_quarterly_ppp))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] FALSE</code></pre>
</div>
</div>
</section>
<section id="creating-point-events-objects-in-owin-object-1" class="level3">
<h3 class="anchored" data-anchor-id="creating-point-events-objects-in-owin-object-1"><strong>5.2.4 Creating point events objects in <em>owin</em> Object</strong></h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb42"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb42-1"><a href="#cb42-1" aria-hidden="true" tabindex="-1"></a>conflict_quarterly_Map_ppp <span class="ot">=</span> conflict_quarterly_ppp[myanmar_owin]</span>
<span id="cb42-2"><a href="#cb42-2" aria-hidden="true" tabindex="-1"></a><span class="co">#summary(conflict_quarterly_Map_ppp)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
</section>
<section id="openstreetmap" class="level2">
<h2 class="anchored" data-anchor-id="openstreetmap"><strong>5.3 OpenStreetMap</strong></h2>
<p>Since the file is quite large we should try to reduce the size of the file</p>
<section id="data-clean-up" class="level3">
<h3 class="anchored" data-anchor-id="data-clean-up"><strong>5.3.1 Data clean up</strong></h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb43"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb43-1"><a href="#cb43-1" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(osm)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> [1] "osm_id"   "code"     "fclass"   "name"     "ref"      "oneway"  
 [7] "maxspeed" "layer"    "bridge"   "tunnel"   "geometry"</code></pre>
</div>
</div>
<p>Looking at the headers, fclass seems interesting.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb45"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb45-1"><a href="#cb45-1" aria-hidden="true" tabindex="-1"></a><span class="fu">unique</span>(osm<span class="sc">$</span>fclass)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> [1] "primary"        "secondary"      "unclassified"   "residential"   
 [5] "trunk_link"     "primary_link"   "tertiary"       "service"       
 [9] "footway"        "track"          "trunk"          "path"          
[13] "living_street"  "track_grade4"   "secondary_link" "unknown"       
[17] "track_grade5"   "motorway"       "steps"          "track_grade2"  
[21] "track_grade1"   "track_grade3"   "tertiary_link"  "motorway_link" 
[25] "pedestrian"     "cycleway"       "bridleway"     </code></pre>
</div>
</div>
<p>We will keep these fclasses: “primary”, “secondary”, “residential”, “trunk_link”, “primary_link”, “tertiary”, “footway”, “trunk”, “secondary_link”, “tertiary_link”.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb47"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb47-1"><a href="#cb47-1" aria-hidden="true" tabindex="-1"></a>fclasses <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"primary"</span>, <span class="st">"secondary"</span>, <span class="st">"residential"</span>, <span class="st">"trunk_link"</span>, <span class="st">"primary_link"</span>, <span class="st">"tertiary"</span>, <span class="st">"footway"</span>, <span class="st">"trunk"</span>, <span class="st">"secondary_link"</span>, <span class="st">"tertiary_link"</span>)</span>
<span id="cb47-2"><a href="#cb47-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-3"><a href="#cb47-3" aria-hidden="true" tabindex="-1"></a>osm <span class="ot">&lt;-</span> osm[osm<span class="sc">$</span>fclass <span class="sc">%in%</span> fclasses, ]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>To further reduce the size, we keep only osm_id and fclass</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb48"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb48-1"><a href="#cb48-1" aria-hidden="true" tabindex="-1"></a>osm <span class="ot">&lt;-</span> osm <span class="sc">%&gt;%</span> dplyr<span class="sc">::</span><span class="fu">select</span>(<span class="st">'osm_id'</span>, <span class="st">'fclass'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>We also have to transform the crs:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb49"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb49-1"><a href="#cb49-1" aria-hidden="true" tabindex="-1"></a>osm <span class="ot">&lt;-</span> <span class="fu">st_transform</span>(osm, <span class="at">crs =</span> <span class="dv">32647</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="merging-osm-and-sf" class="level3">
<h3 class="anchored" data-anchor-id="merging-osm-and-sf"><strong>5.3.2 Merging osm and sf</strong></h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb50"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb50-1"><a href="#cb50-1" aria-hidden="true" tabindex="-1"></a>merged_myanmar <span class="ot">&lt;-</span> <span class="fu">st_union</span>(myanmar_sf)</span>
<span id="cb50-2"><a href="#cb50-2" aria-hidden="true" tabindex="-1"></a>osm_myanmar <span class="ot">&lt;-</span> <span class="fu">st_intersection</span>(osm, merged_myanmar)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Rds is written for future readings:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb51"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb51-1"><a href="#cb51-1" aria-hidden="true" tabindex="-1"></a><span class="fu">write_rds</span>(osm_myanmar, <span class="st">"data/rds/osm_myanmar.rds"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb52"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb52-1"><a href="#cb52-1" aria-hidden="true" tabindex="-1"></a>osm_myanmar <span class="ot">&lt;-</span> <span class="fu">read_rds</span>(<span class="st">"data/rds/osm_myanmar.rds"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Some geometries in the <code>osm</code> dataset are stored as <code>MULTILINESTRING</code>, which may cause issues during KDE calculations. To address this, we will split them into individual <code>LINESTRING</code> geometries.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb53"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb53-1"><a href="#cb53-1" aria-hidden="true" tabindex="-1"></a>osm_myanmar <span class="ot">&lt;-</span> <span class="fu">st_cast</span>(<span class="fu">st_cast</span>(osm_myanmar, <span class="st">"MULTILINESTRING"</span>),<span class="st">"LINESTRING"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in st_cast.sf(st_cast(osm_myanmar, "MULTILINESTRING"), "LINESTRING"):
repeating attributes for all sub-geometries for which they may not be constant</code></pre>
</div>
<div class="sourceCode cell-code" id="cb55"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb55-1"><a href="#cb55-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(osm_myanmar)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>    osm_id             fclass                   geometry     
 Length:273089      Length:273089      LINESTRING   :273089  
 Class :character   Class :character   epsg:32647   :     0  
 Mode  :character   Mode  :character   +proj=utm ...:     0  </code></pre>
</div>
</div>
</section>
</section>
</section>
<section id="first-order-spatial-point-patterns-analysis" class="level1">
<h1><strong>6 First-order Spatial Point Patterns Analysis</strong></h1>
<section id="kernel-density-estimation" class="level2">
<h2 class="anchored" data-anchor-id="kernel-density-estimation"><strong>6.1 Kernel Density Estimation</strong></h2>
<section id="rescaling-kde-layers" class="level3">
<h3 class="anchored" data-anchor-id="rescaling-kde-layers"><strong>6.1.1 Rescaling KDE Layers</strong></h3>
<p>Since the distance is in meters we have to use <code>rescale()</code> function of <strong>spatstat</strong> package to covert the unit of measurement from meter to kilometer.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb57"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb57-1"><a href="#cb57-1" aria-hidden="true" tabindex="-1"></a><span class="co"># overall</span></span>
<span id="cb57-2"><a href="#cb57-2" aria-hidden="true" tabindex="-1"></a>conflictmyanmar_ppp.km <span class="ot">&lt;-</span> <span class="fu">rescale</span>(conflictmyanmar_ppp, <span class="dv">1000</span>, <span class="st">"km"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb58"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb58-1"><a href="#cb58-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Define a function covert the unit of measurement from meter to kilometer</span></span>
<span id="cb58-2"><a href="#cb58-2" aria-hidden="true" tabindex="-1"></a>rescale_km_func <span class="ot">&lt;-</span> <span class="cf">function</span>(ppp) {</span>
<span id="cb58-3"><a href="#cb58-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rescale</span>(ppp, <span class="dv">1000</span>, <span class="st">"km"</span>)</span>
<span id="cb58-4"><a href="#cb58-4" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb58-5"><a href="#cb58-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb58-6"><a href="#cb58-6" aria-hidden="true" tabindex="-1"></a>conflictmyanmar_ppp_km_list <span class="ot">&lt;-</span> <span class="fu">map</span>(conflictmyanmar_ppp_list, rescale_km_func)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="quarterly-kde-layers" class="level3">
<h3 class="anchored" data-anchor-id="quarterly-kde-layers">6.1.2 Quarterly KDE layers</h3>
<p>To have a understanding of what the value of sigma to use for the KDE layer, we plot using sigma value of 10, 25, 50, 100 on 2021 Q1.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb59"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb59-1"><a href="#cb59-1" aria-hidden="true" tabindex="-1"></a>myanmar_conflict_quarterly_Map_bw10 <span class="ot">&lt;-</span> <span class="fu">density</span>(conflictmyanmar_ppp_km_list[[<span class="st">"2021.Q1"</span>]], <span class="at">sigma =</span> <span class="dv">10</span>, <span class="at">edge =</span> <span class="cn">TRUE</span>, <span class="at">kernel =</span> <span class="st">"gaussian"</span>)</span>
<span id="cb59-2"><a href="#cb59-2" aria-hidden="true" tabindex="-1"></a>myanmar_conflict_quarterly_Map_bw25 <span class="ot">&lt;-</span> <span class="fu">density</span>(conflictmyanmar_ppp_km_list[[<span class="st">"2021.Q1"</span>]], <span class="at">sigma =</span> <span class="dv">25</span>, <span class="at">edge =</span> <span class="cn">TRUE</span>, <span class="at">kernel =</span> <span class="st">"gaussian"</span>)</span>
<span id="cb59-3"><a href="#cb59-3" aria-hidden="true" tabindex="-1"></a>myanmar_conflict_quarterly_Map_bw50 <span class="ot">&lt;-</span> <span class="fu">density</span>(conflictmyanmar_ppp_km_list[[<span class="st">"2021.Q1"</span>]], <span class="at">sigma =</span> <span class="dv">50</span>, <span class="at">edge =</span> <span class="cn">TRUE</span>, <span class="at">kernel =</span> <span class="st">"gaussian"</span>)</span>
<span id="cb59-4"><a href="#cb59-4" aria-hidden="true" tabindex="-1"></a>myanmar_conflict_quarterly_Map_bw100 <span class="ot">&lt;-</span> <span class="fu">density</span>(conflictmyanmar_ppp_km_list[[<span class="st">"2021.Q1"</span>]], <span class="at">sigma =</span> <span class="dv">100</span>, <span class="at">edge =</span> <span class="cn">TRUE</span>, <span class="at">kernel =</span> <span class="st">"gaussian"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb60"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb60-1"><a href="#cb60-1" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow=</span><span class="fu">c</span>(<span class="dv">2</span>,<span class="dv">2</span>))</span>
<span id="cb60-2"><a href="#cb60-2" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mar =</span> <span class="fu">c</span>(<span class="dv">3</span>,<span class="dv">2</span>,<span class="dv">2</span>,<span class="dv">1</span>))</span>
<span id="cb60-3"><a href="#cb60-3" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(myanmar_conflict_quarterly_Map_bw10, <span class="at">main =</span> <span class="st">"10"</span>)</span>
<span id="cb60-4"><a href="#cb60-4" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(myanmar_conflict_quarterly_Map_bw25, <span class="at">main =</span> <span class="st">"25"</span>)</span>
<span id="cb60-5"><a href="#cb60-5" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(myanmar_conflict_quarterly_Map_bw50, <span class="at">main =</span> <span class="st">"50"</span>)</span>
<span id="cb60-6"><a href="#cb60-6" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(myanmar_conflict_quarterly_Map_bw100, <span class="at">main =</span> <span class="st">"100"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Take-home_Ex01_files/figure-html/unnamed-chunk-42-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>From the plot, sigma value of 50 looks like a good representation.</p>
<p>Now we plot the graphs:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb61"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb61-1"><a href="#cb61-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Define get kde</span></span>
<span id="cb61-2"><a href="#cb61-2" aria-hidden="true" tabindex="-1"></a>rescale_km_func <span class="ot">&lt;-</span> <span class="cf">function</span>(pppkm) {</span>
<span id="cb61-3"><a href="#cb61-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">density</span>(pppkm,</span>
<span id="cb61-4"><a href="#cb61-4" aria-hidden="true" tabindex="-1"></a>          <span class="at">sigma=</span><span class="dv">50</span>, </span>
<span id="cb61-5"><a href="#cb61-5" aria-hidden="true" tabindex="-1"></a>          <span class="at">edge=</span><span class="cn">TRUE</span>, </span>
<span id="cb61-6"><a href="#cb61-6" aria-hidden="true" tabindex="-1"></a>          <span class="at">kernel=</span><span class="st">"gaussian"</span>)</span>
<span id="cb61-7"><a href="#cb61-7" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb61-8"><a href="#cb61-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb61-9"><a href="#cb61-9" aria-hidden="true" tabindex="-1"></a>kde_conflictmyanmar_list <span class="ot">&lt;-</span> <span class="fu">map</span>(conflictmyanmar_ppp_km_list, rescale_km_func)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb62"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb62-1"><a href="#cb62-1" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfcol=</span><span class="fu">c</span>(<span class="dv">2</span>,<span class="dv">2</span>), </span>
<span id="cb62-2"><a href="#cb62-2" aria-hidden="true" tabindex="-1"></a>    <span class="at">mar=</span><span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">1</span>),</span>
<span id="cb62-3"><a href="#cb62-3" aria-hidden="true" tabindex="-1"></a>    <span class="at">cex.axis=</span><span class="fl">0.7</span>,        </span>
<span id="cb62-4"><a href="#cb62-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">cex.main=</span><span class="fl">0.8</span>) </span>
<span id="cb62-5"><a href="#cb62-5" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (quarter <span class="cf">in</span> <span class="fu">names</span>(kde_conflictmyanmar_list)) {</span>
<span id="cb62-6"><a href="#cb62-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">plot</span>(kde_conflictmyanmar_list[[quarter]], <span class="at">main =</span> quarter)</span>
<span id="cb62-7"><a href="#cb62-7" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Take-home_Ex01_files/figure-html/unnamed-chunk-44-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Take-home_Ex01_files/figure-html/unnamed-chunk-44-2.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Take-home_Ex01_files/figure-html/unnamed-chunk-44-3.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Take-home_Ex01_files/figure-html/unnamed-chunk-44-4.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="quarterly-spatio-temporal-kde-layers" class="level3">
<h3 class="anchored" data-anchor-id="quarterly-spatio-temporal-kde-layers">6.1.3 Quarterly spatio-temporal KDE layers</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb63"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb63-1"><a href="#cb63-1" aria-hidden="true" tabindex="-1"></a>conflict_quarterly_Map_ppp <span class="ot">=</span> <span class="fu">rescale</span>(conflict_quarterly_Map_ppp, <span class="dv">1000</span>, <span class="st">"km"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb64"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb64-1"><a href="#cb64-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(conflict_quarterly_Map_ppp)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Take-home_Ex01_files/figure-html/unnamed-chunk-46-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb65"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb65-1"><a href="#cb65-1" aria-hidden="true" tabindex="-1"></a>st_kde <span class="ot">&lt;-</span> <span class="fu">spattemp.density</span>(conflict_quarterly_Map_ppp)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Calculating trivariate smooth...Done.
Edge-correcting...Done.
Conditioning on time...Done.</code></pre>
</div>
<div class="sourceCode cell-code" id="cb67"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb67-1"><a href="#cb67-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(st_kde)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Spatiotemporal Kernel Density Estimate

Bandwidths
  h = 39.5528 (spatial)
  lambda = 0.0031 (temporal)

No. of observations
  87644 

Spatial bound
  Type: polygonal
  2D enclosure: [-210.0086, 724.6476] x [1072.026, 3158.467]

Temporal bound
  [1, 14]

Evaluation
  128 x 128 x 14 trivariate lattice
  Density range: [1.024509e-21, 0.0003297299]</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb69"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb69-1"><a href="#cb69-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 1 to 14 for each quarter</span></span>
<span id="cb69-2"><a href="#cb69-2" aria-hidden="true" tabindex="-1"></a>tims <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">14</span>)</span>
<span id="cb69-3"><a href="#cb69-3" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfcol=</span><span class="fu">c</span>(<span class="dv">2</span>,<span class="dv">2</span>), </span>
<span id="cb69-4"><a href="#cb69-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">mar=</span><span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">1</span>),</span>
<span id="cb69-5"><a href="#cb69-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">cex.axis=</span><span class="fl">0.7</span>,        </span>
<span id="cb69-6"><a href="#cb69-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">cex.main=</span><span class="fl">0.8</span>)</span>
<span id="cb69-7"><a href="#cb69-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb69-8"><a href="#cb69-8" aria-hidden="true" tabindex="-1"></a><span class="co"># function to map tims to "Year QQuarter"</span></span>
<span id="cb69-9"><a href="#cb69-9" aria-hidden="true" tabindex="-1"></a>get_quarter_label <span class="ot">&lt;-</span> <span class="cf">function</span>(i) {</span>
<span id="cb69-10"><a href="#cb69-10" aria-hidden="true" tabindex="-1"></a>  year <span class="ot">&lt;-</span> <span class="dv">2021</span> <span class="sc">+</span> (i <span class="sc">-</span> <span class="dv">1</span>) <span class="sc">%/%</span> <span class="dv">4</span>  <span class="co"># Calculate the year</span></span>
<span id="cb69-11"><a href="#cb69-11" aria-hidden="true" tabindex="-1"></a>  quarter <span class="ot">&lt;-</span> (i <span class="sc">-</span> <span class="dv">1</span>) <span class="sc">%%</span> <span class="dv">4</span> <span class="sc">+</span> <span class="dv">1</span>   <span class="co"># Calculate the quarter (1 to 4)</span></span>
<span id="cb69-12"><a href="#cb69-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(<span class="fu">paste</span>(year, <span class="st">"Q"</span>, quarter, <span class="at">sep =</span> <span class="st">""</span>))</span>
<span id="cb69-13"><a href="#cb69-13" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb69-14"><a href="#cb69-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb69-15"><a href="#cb69-15" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> tims){ </span>
<span id="cb69-16"><a href="#cb69-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">plot</span>(st_kde, i, </span>
<span id="cb69-17"><a href="#cb69-17" aria-hidden="true" tabindex="-1"></a>       <span class="at">override.par=</span><span class="cn">FALSE</span>, </span>
<span id="cb69-18"><a href="#cb69-18" aria-hidden="true" tabindex="-1"></a>       <span class="at">fix.range=</span><span class="cn">TRUE</span>, </span>
<span id="cb69-19"><a href="#cb69-19" aria-hidden="true" tabindex="-1"></a>       <span class="at">main=</span><span class="fu">get_quarter_label</span>(i))</span>
<span id="cb69-20"><a href="#cb69-20" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Take-home_Ex01_files/figure-html/unnamed-chunk-48-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Take-home_Ex01_files/figure-html/unnamed-chunk-48-2.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Take-home_Ex01_files/figure-html/unnamed-chunk-48-3.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Take-home_Ex01_files/figure-html/unnamed-chunk-48-4.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="openstreetmap-1" class="level3">
<h3 class="anchored" data-anchor-id="openstreetmap-1">6.1.4 OpenStreetMap</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb70"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb70-1"><a href="#cb70-1" aria-hidden="true" tabindex="-1"></a>osm_density <span class="ot">&lt;-</span> <span class="fu">density</span>(conflictmyanmar_ppp_km_list[[<span class="st">"2021.Q4"</span>]], </span>
<span id="cb70-2"><a href="#cb70-2" aria-hidden="true" tabindex="-1"></a>             <span class="at">sigma=</span><span class="dv">50</span>, </span>
<span id="cb70-3"><a href="#cb70-3" aria-hidden="true" tabindex="-1"></a>             <span class="at">edge=</span><span class="cn">TRUE</span>, </span>
<span id="cb70-4"><a href="#cb70-4" aria-hidden="true" tabindex="-1"></a>             <span class="at">kernel=</span><span class="st">"gaussian"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb71"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb71-1"><a href="#cb71-1" aria-hidden="true" tabindex="-1"></a>density_raster <span class="ot">&lt;-</span> <span class="fu">raster</span>(osm_density)</span>
<span id="cb71-2"><a href="#cb71-2" aria-hidden="true" tabindex="-1"></a><span class="fu">projection</span>(density_raster) <span class="ot">&lt;-</span> <span class="fu">CRS</span>(<span class="st">"+init=EPSG:32647"</span>)</span>
<span id="cb71-3"><a href="#cb71-3" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(osm_myanmar)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Take-home_Ex01_files/figure-html/unnamed-chunk-50-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="interpretations" class="level3">
<h3 class="anchored" data-anchor-id="interpretations">6.1.5 Interpretations</h3>
<p>From the KDE and STKDE plots, the area around Mandalay, Sagaing, Kachin and Magway has a concentration of conflicts. The regions of Bago and Yangon also have some indications of clusters of conflicts.</p>
</section>
</section>
</section>
<section id="second-order-analysis" class="level1">
<h1>7 Second-order analysis</h1>
<p>After looking at the quarterly KDE layers these three areas have the highest amount of conflicts occurring in the Dry Zones: Magway, Sagaing, Mandalay.</p>
<p>The aims of conflict actors in the Dry Zone are relatively straightforward: <a href="https://myanmar.iiss.org/analysis/dryzone">to sustain the coup or overturn it</a>.</p>
<p>Sagaing Region has emerged as a <a href="https://www.frontiermyanmar.net/en/conflicts-deepen-between-resistance-groups-in-sagaing/">stronghold of resistance to military rule</a> plagued by factionalism and in-fighting.</p>
<p>We will focus on these areas to understand the distributions of the conflicts instead of all the regions.</p>
<section id="second-order-analysis-data-wrangling" class="level2">
<h2 class="anchored" data-anchor-id="second-order-analysis-data-wrangling"><strong>7.1 Second-order analysis Data Wrangling</strong></h2>
<section id="study-areas-filtering" class="level4">
<h4 class="anchored" data-anchor-id="study-areas-filtering">7.1.1 Study areas filtering</h4>
<p>The code chunk below targets the three areas mentioned previously.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb72"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb72-1"><a href="#cb72-1" aria-hidden="true" tabindex="-1"></a>MW <span class="ot">&lt;-</span> myanmar_sf <span class="sc">%&gt;%</span></span>
<span id="cb72-2"><a href="#cb72-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(ST <span class="sc">==</span> <span class="st">"Magway"</span>)</span>
<span id="cb72-3"><a href="#cb72-3" aria-hidden="true" tabindex="-1"></a>SGI <span class="ot">&lt;-</span> myanmar_sf <span class="sc">%&gt;%</span></span>
<span id="cb72-4"><a href="#cb72-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(ST <span class="sc">==</span> <span class="st">"Sagaing"</span>)</span>
<span id="cb72-5"><a href="#cb72-5" aria-hidden="true" tabindex="-1"></a>MDL <span class="ot">&lt;-</span> myanmar_sf <span class="sc">%&gt;%</span></span>
<span id="cb72-6"><a href="#cb72-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(ST <span class="sc">==</span> <span class="st">"Mandalay"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="converting-sf-objects-into-owin-objects" class="level4">
<h4 class="anchored" data-anchor-id="converting-sf-objects-into-owin-objects">7.1.2 Converting sf objects into <strong><em>owin</em></strong> objects</h4>
<p><strong>Spatstat</strong> requires the conversion of these sf objects into owin objects.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb73"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb73-1"><a href="#cb73-1" aria-hidden="true" tabindex="-1"></a>MW_owin <span class="ot">&lt;-</span> <span class="fu">as.owin</span>(MW)</span>
<span id="cb73-2"><a href="#cb73-2" aria-hidden="true" tabindex="-1"></a>SGI_owin <span class="ot">&lt;-</span> <span class="fu">as.owin</span>(SGI)</span>
<span id="cb73-3"><a href="#cb73-3" aria-hidden="true" tabindex="-1"></a>MDL_owin <span class="ot">&lt;-</span> <span class="fu">as.owin</span>(MDL)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="creating-event-points" class="level4">
<h4 class="anchored" data-anchor-id="creating-event-points">7.1.3 Creating event points</h4>
<div class="cell">
<div class="sourceCode cell-code" id="cb74"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb74-1"><a href="#cb74-1" aria-hidden="true" tabindex="-1"></a>MW_ppp <span class="ot">=</span> conflict_ppp_jit[MW_owin]</span>
<span id="cb74-2"><a href="#cb74-2" aria-hidden="true" tabindex="-1"></a>SGI_ppp <span class="ot">=</span> conflict_ppp_jit[SGI_owin]</span>
<span id="cb74-3"><a href="#cb74-3" aria-hidden="true" tabindex="-1"></a>MDL_ppp <span class="ot">=</span> conflict_ppp_jit[MDL_owin]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p><code>rescale()</code> to transform from meters to kilometers for its distance.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb75"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb75-1"><a href="#cb75-1" aria-hidden="true" tabindex="-1"></a>MW_ppp.km <span class="ot">=</span> <span class="fu">rescale</span>(MW_ppp, <span class="dv">1000</span>, <span class="st">"km"</span>)</span>
<span id="cb75-2"><a href="#cb75-2" aria-hidden="true" tabindex="-1"></a>SGI_ppp.km <span class="ot">=</span> <span class="fu">rescale</span>(SGI_ppp, <span class="dv">1000</span>, <span class="st">"km"</span>)</span>
<span id="cb75-3"><a href="#cb75-3" aria-hidden="true" tabindex="-1"></a>MDL_ppp.km <span class="ot">=</span> <span class="fu">rescale</span>(MDL_ppp, <span class="dv">1000</span>, <span class="st">"km"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>The three area of interests are as shown:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb76"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb76-1"><a href="#cb76-1" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow=</span><span class="fu">c</span>(<span class="dv">2</span>,<span class="dv">2</span>))</span>
<span id="cb76-2"><a href="#cb76-2" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mar =</span> <span class="fu">c</span>(<span class="dv">3</span>,<span class="dv">2</span>,<span class="dv">2</span>,<span class="dv">1</span>))</span>
<span id="cb76-3"><a href="#cb76-3" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(MW_ppp.km, <span class="at">main=</span><span class="st">"Magway"</span>)</span>
<span id="cb76-4"><a href="#cb76-4" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(SGI_ppp.km, <span class="at">main=</span><span class="st">"Sagaing"</span>)</span>
<span id="cb76-5"><a href="#cb76-5" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(MDL_ppp.km, <span class="at">main=</span><span class="st">"Mandalay"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Take-home_Ex01_files/figure-html/unnamed-chunk-55-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
</section>
<section id="g-function-for-spatial-point-process-analysis" class="level2">
<h2 class="anchored" data-anchor-id="g-function-for-spatial-point-process-analysis"><strong>7.2 G-Function for Spatial Point Process Analysis</strong></h2>
<p>We use G-function to determine if conflicts are occurring closer together than would be expected under random conditions, indicating potential hot spots.</p>
<section id="magway-area" class="level3">
<h3 class="anchored" data-anchor-id="magway-area">7.2.1 Magway area</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb77"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb77-1"><a href="#cb77-1" aria-hidden="true" tabindex="-1"></a>G_MW <span class="ot">=</span> <span class="fu">Gest</span>(MW_ppp, <span class="at">correction =</span> <span class="st">"rs"</span>)</span>
<span id="cb77-2"><a href="#cb77-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(G_MW, <span class="at">xlim=</span><span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">50</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Take-home_Ex01_files/figure-html/unnamed-chunk-56-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>To confirm the observed spatial patterns above, a hypothesis test will be conducted. The hypothesis and test are as follows:</p>
<p>Ho = The distribution of events in Magway are randomly distributed.</p>
<p>H1= The distribution of events in Magway are not randomly distributed.</p>
<p>The null hypothesis will be rejected if p-value is smaller than alpha value of 0.001.</p>
<p>Monte Carlo test with G-function:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb78"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb78-1"><a href="#cb78-1" aria-hidden="true" tabindex="-1"></a>G_MW.csr <span class="ot">&lt;-</span> <span class="fu">envelope</span>(MW_ppp, Gest, <span class="at">nsim =</span> <span class="dv">249</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Generating 249 simulations of CSR  ...
1, 2, 3, 4.6.8.10.12.14.16.18.20.22.24.26.28.30.32.34
.36.38.40.42.44.46.48.50.52.54.56.58.60.62.64.66.68.70.72.74
.76.78.80.82.84.86.88.90.92.94.96.98.100.102.104.106.108.110.112.114
.116.118.120.122.124.126.128.130.132.134.136.138.140.142.144.146.148.150.152.154
.156.158.160.162.164.166.168.170.172.174.176.178.180.182.184.186.188.190.192.194
.196.198.200.202.204.206.208.210.212.214.216.218.220.222.224.226.228.230.232.234
.236.238.240.242.244.246.248
249.

Done.</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb80"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb80-1"><a href="#cb80-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(G_MW.csr)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Take-home_Ex01_files/figure-html/unnamed-chunk-58-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="sagaing-area" class="level3">
<h3 class="anchored" data-anchor-id="sagaing-area">7.2.2 Sagaing area</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb81"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb81-1"><a href="#cb81-1" aria-hidden="true" tabindex="-1"></a>G_SGI <span class="ot">=</span> <span class="fu">Gest</span>(SGI_ppp, <span class="at">correction =</span> <span class="st">"border"</span>)</span>
<span id="cb81-2"><a href="#cb81-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(G_SGI, <span class="at">xlim=</span><span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">50</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Take-home_Ex01_files/figure-html/unnamed-chunk-59-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>To confirm the observed spatial patterns above, a hypothesis test will be conducted. The hypothesis and test are as follows:</p>
<p>Ho = The distribution of events in Sagaing are randomly distributed.</p>
<p>H1= The distribution of events in Sagaing are not randomly distributed.</p>
<p>The null hypothesis will be rejected if p-value is smaller than alpha value of 0.001.</p>
<p>Monte Carlo test with G-function:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb82"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb82-1"><a href="#cb82-1" aria-hidden="true" tabindex="-1"></a>G_SGI.csr <span class="ot">&lt;-</span> <span class="fu">envelope</span>(SGI_ppp, Gest, <span class="at">nsim =</span> <span class="dv">249</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Generating 249 simulations of CSR  ...
1, 2,  [4:05 remaining] 3, 4 [4:04 remaining] .6 [4:03 remaining] .8
 [4:02 remaining] .10 [4:03 remaining] .12 [4:13 remaining] .14 [4:23 remaining] .
16 [4:21 remaining] .18 [4:20 remaining] .20 [4:18 remaining] .22
 [4:18 remaining] .24 [4:13 remaining] .26 [4:08 remaining] .28 [4:05 remaining] .
30 [4:01 remaining] .32 [3:57 remaining] .34 [3:54 remaining] .36
 [3:51 remaining] .38 [3:48 remaining] .40 [3:47 remaining] .42 [3:44 remaining] .
44 [3:42 remaining] .46 [3:39 remaining] .48 [3:36 remaining] .50
 [3:34 remaining] .52 [3:33 remaining] .54 [3:32 remaining] .56 [3:30 remaining] .
58 [3:27 remaining] .60 [3:25 remaining] .62 [3:23 remaining] .64
 [3:20 remaining] .66 [3:18 remaining] .68 [3:15 remaining] .70 [3:13 remaining] .
72 [3:11 remaining] .74 [3:09 remaining] .76 [3:06 remaining] .78
 [3:04 remaining] .80 [3:01 remaining] .82 [2:59 remaining] .84 [2:57 remaining] .
86 [2:55 remaining] .88 [2:52 remaining] .90 [2:50 remaining] .92
 [2:48 remaining] .94 [2:47 remaining] .96 [2:45 remaining] .98 [2:43 remaining] .
100 [2:40 remaining] .102 [2:38 remaining] .104 [2:36 remaining] .106
 [2:33 remaining] .108 [2:31 remaining] .110 [2:29 remaining] .112 [2:26 remaining] .
114 [2:24 remaining] .116 [2:22 remaining] .118 [2:19 remaining] .120
 [2:17 remaining] .122 [2:16 remaining] .124 [2:14 remaining] .126 [2:12 remaining] .
128 [2:10 remaining] .130 [2:08 remaining] .132 [2:06 remaining] .134
 [2:03 remaining] .136 [2:01 remaining] .138 [1:59 remaining] .140 [1:57 remaining] .
142 [1:55 remaining] .144 [1:53 remaining] .146 [1:51 remaining] .148
 [1:50 remaining] .150 [1:47 remaining] .152 [1:45 remaining] .154 [1:43 remaining] .
156 [1:41 remaining] .158 [1:38 remaining] .160 [1:36 remaining] .162
 [1:34 remaining] .164 [1:31 remaining] .166 [1:29 remaining] .168 [1:27 remaining] .
170 [1:25 remaining] .172 [1:22 remaining] .174 [1:20 remaining] .176
 [1:18 remaining] .178 [1:16 remaining] .180 [1:14 remaining] .182 [1:11 remaining] .
184 [1:09 remaining] .186 [1:07 remaining] .188 [1:05 remaining] .190
 [1:03 remaining] .192 [1:01 remaining] .194 [58 sec remaining] .196 [56 sec remaining] .
198 [54 sec remaining] .200 [52 sec remaining] .202 [50 sec remaining] .204
 [48 sec remaining] .206 [46 sec remaining] .208 [44 sec remaining] .210 [42 sec remaining] .
212 [40 sec remaining] .214 [37 sec remaining] .216 [35 sec remaining] .218
 [33 sec remaining] .220 [31 sec remaining] .222 [29 sec remaining] .224 [27 sec remaining] .
226 [25 sec remaining] .228 [22 sec remaining] .230 [20 sec remaining] .232
 [18 sec remaining] .234 [16 sec remaining] .236 [14 sec remaining] .238 [12 sec remaining] .
240 [10 sec remaining] .242 [8 sec remaining] .244 [5 sec remaining] .246
 [3 sec remaining] .248 [1 sec remaining] 
249.

Done.</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb84"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb84-1"><a href="#cb84-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(G_SGI.csr)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Take-home_Ex01_files/figure-html/unnamed-chunk-61-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="mandalay-area" class="level3">
<h3 class="anchored" data-anchor-id="mandalay-area">7.2.3 Mandalay area</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb85"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb85-1"><a href="#cb85-1" aria-hidden="true" tabindex="-1"></a>G_MDL <span class="ot">=</span> <span class="fu">Gest</span>(MDL_ppp, <span class="at">correction =</span> <span class="st">"border"</span>)</span>
<span id="cb85-2"><a href="#cb85-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(G_MDL, <span class="at">xlim=</span><span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">50</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Take-home_Ex01_files/figure-html/unnamed-chunk-62-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>To confirm the observed spatial patterns above, a hypothesis test will be conducted. The hypothesis and test are as follows:</p>
<p>Ho = The distribution of events in Mandalay are randomly distributed.</p>
<p>H1= The distribution of events in Mandalay are not randomly distributed.</p>
<p>The null hypothesis will be rejected if p-value is smaller than alpha value of 0.001.</p>
<p>Monte Carlo test with G-function:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb86"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb86-1"><a href="#cb86-1" aria-hidden="true" tabindex="-1"></a>G_MDL.csr <span class="ot">&lt;-</span> <span class="fu">envelope</span>(MDL_ppp, Gest, <span class="at">nsim =</span> <span class="dv">249</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Generating 249 simulations of CSR  ...
1, 2, 3, 4.6.8.10.12.14.16.18.20.22.24.26.28.30.32.34
.36.38.40.42.44.46.48.50.52.54.56.58.60.62.64.66.68.70.72.74
.76.78.80.82.84.86.88.90.92.94.96.98.100.102.104.106.108.110.112.114
.116.118.120.122.124.126.128.130.132.134.136.138.140.142.144.146.148.150.152.154
.156.158.160.162.164.166.168.170.172.174.176.178.180.182.184.186.188.190.192.194
.196.198.200.202.204.206.208.210.212.214.216.218.220.222.224.226.228.230.232.234
.236.238.240.242.244.246.248
249.

Done.</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb88"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb88-1"><a href="#cb88-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(G_MDL.csr)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Take-home_Ex01_files/figure-html/unnamed-chunk-64-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="interpretation-of-g-function" class="level3">
<h3 class="anchored" data-anchor-id="interpretation-of-g-function">7.2.4 Interpretation of G-Function</h3>
<p>The observed G-function (solid line) deviates significantly from the theoretical and envelope lines, rising sharply and reaching a higher value.</p>
<p>This deviation suggests that the events in the three regions are not randomly distributed. The observed pattern shows clustering or aggregation of events at shorter distances. Given the sharp rise and high values of the observed function compared to the theoretical expectations, it’s likely that the null hypothesis will be rejected, indicating that the distribution of events in three regions is significantly different from a random spatial distribution.</p>
<p>The analysis suggests the presence of spatial autocorrelation or clustering in the three regions area, which could be important for understanding the underlying spatial processes or patterns in the region.</p>
</section>
</section>
</section>
<section id="conclusion" class="level1">
<h1>8 Conclusion</h1>
<p>The spatial analysis of conflict events in Myanmar reveals significant clustering patterns, particularly when comparing the observed G-function with theoretical expectations. The observed G-function deviates sharply from the theoretical and envelope lines, suggesting that conflict events are not randomly distributed but instead show a tendency to cluster at shorter distances. This pattern indicates spatial autocorrelation, and the null hypothesis of random distribution is likely to be rejected.</p>
<p>Further insights from KDE and STKDE plots highlight concentrated conflict zones around Mandalay, Sagaing, Kachin, and Magway. Additionally, regions like Bago and Yangon show indications of conflict clusters. These findings suggest that specific regions in Myanmar experience more frequent or intense conflict activity, underscoring the need to explore underlying causes of spatial clustering in these areas. This clustering could be crucial for understanding the broader spatial processes driving conflict in the country.</p>
<p>This study’s identification of conflict clusters across regions in Myanmar, particularly in areas like Mandalay, Sagaing, Kachin, Magway, Bago, and Yangon, should provides critical insights into the spatial dynamics of conflict. Understanding where and how these conflicts concentrate can inform targeted peace building efforts, helping policymakers and organizations focus resources on the most affected areas. By addressing the root causes of conflict in these regions, this spatial analysis can play a pivotal role in fostering dialogue, promoting stability, and ultimately contributing to a more peaceful resolution of ongoing tensions in Myanmar.</p>


</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp('/' + window.location.host + '/');
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      // TODO in 1.5, we should make sure this works without a callout special case
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->




</body></html>